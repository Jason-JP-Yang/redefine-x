export default function initAutoHover(){!function initHomeArticleAutoHover(){const e=document.querySelector(".home-article-list");if(!e||"1"===e.dataset.autoHoverInit)return;e.dataset.autoHoverInit="1";const t=Array.from(e.querySelectorAll(".home-article-item"));if(!t.length)return;let n=null,i=!1,o=!1;const a="a,button,input,textarea,select,summary,[role='button'],[tabindex]:not([tabindex='-1']),.home-article-item",isListInView=()=>{const t=e.getBoundingClientRect();return t.bottom>0&&t.top<window.innerHeight},update=()=>{if(i=!1,!isListInView()||o)return n&&n.classList.remove("auto-hover"),void(n=null);const e=window.innerHeight/2;let a=null,s=1/0;for(const n of t){const t=n.getBoundingClientRect();if(t.bottom<=0||t.top>=window.innerHeight)continue;const i=Math.abs(t.top+t.height/2-e);i<s&&(s=i,a=n)}a!==n&&(n&&n.classList.remove("auto-hover"),a&&a.classList.add("auto-hover"),n=a)},requestUpdate=()=>{i||(i=!0,requestAnimationFrame(update))},setUserHover=e=>{o!==e&&(o=e,e&&n&&(n.classList.remove("auto-hover"),n=null),requestUpdate())};document.addEventListener("pointerover",(e=>{e.target&&e.target.closest(a)&&setUserHover(!0)}),{passive:!0}),document.addEventListener("pointerout",(e=>{const t=e.relatedTarget;t&&t.closest&&t.closest(a)||setUserHover(!1)}),{passive:!0}),window.addEventListener("scroll",requestUpdate,{passive:!0}),window.addEventListener("resize",requestUpdate),requestUpdate()}(),function initArticleMediaAutoHover(){const n=document.documentElement;"1"!==n.dataset.articleMediaAutoHoverGlobalInit&&(n.dataset.articleMediaAutoHoverGlobalInit="1",function installGlobalListeners(){document.addEventListener("pointerover",(n=>{const i=n.target;i&&i.closest&&(e.active&&i.closest(".auto-hover")||i.closest(t)&&(e.hoveringInteractive=!0,clearActive()))}),{passive:!0}),document.addEventListener("pointerout",(n=>{const i=n.relatedTarget;i&&i.closest&&i.closest(t)||(e.hoveringInteractive=!1,requestUpdate())}),{passive:!0}),document.addEventListener("pointerdown",(t=>{const n=t.target;let i=!1;if(n)for(const t of e.candidates)if(t.element.contains(n)){i=!0;break}const o=i?1e4:1500;e.suspendUntil=Date.now()+o,e.hoveringInteractive=!1,clearActive(),e.resumeTimer&&clearTimeout(e.resumeTimer),e.resumeTimer=setTimeout((()=>{requestUpdate()}),o)}),{passive:!0}),window.addEventListener("scroll",requestUpdate,{passive:!0}),window.addEventListener("resize",(()=>{refreshCandidates(),requestUpdate()}));try{swup.hooks.on("page:view",(()=>{refreshCandidates(),requestUpdate()}))}catch(e){}}());refreshCandidates(),requestUpdate()}()}const e={candidates:[],active:null,ticking:!1,hoveringInteractive:!1,suspendUntil:0,resumeTimer:null},t="a,button,input,textarea,select,summary,[role='button'],[tabindex]:not([tabindex='-1']),.page-aside-toggle,.right-bottom-tools,.right-bottom-tools *,.post-toc,.post-toc *,.navbar,.navbar *";function refreshCandidates(){const t=[];document.querySelectorAll("figure.image-caption").forEach((e=>{const n=e.querySelector("img, .img-preloader");n&&(e.classList.contains("image-exif-container")||t.push({type:"caption",element:e,img:n}))}));document.querySelectorAll(".image-exif-container.image-exif-float").forEach((e=>{const n=e.querySelector("img, .img-preloader");n&&t.push({type:"exif-float",element:e,img:n})})),e.candidates=t,e.active&&!e.candidates.some((t=>t.element===e.active.element))&&clearActive()}function clearActive(){e.active&&(e.active.element.classList.remove("auto-hover"),e.active=null)}function isInCenterBand(e,t){const n=t/2,i=.15*t,o=e.top+e.height/2;return Math.abs(o-n)<=i}function update(){if(e.ticking=!1,!e.candidates.length)return;if(function shouldSuspend(){return e.hoveringInteractive||Date.now()<e.suspendUntil}()){const t=window.innerHeight;const n=t/2;let i=null,o=1/0;for(const a of e.candidates){const e=a.img.getBoundingClientRect();if(e.bottom<=0||e.top>=t)continue;const s=Math.abs(e.top+e.height/2-n);s<o&&(o=s,i=a)}if(i){const n=i.img.getBoundingClientRect();if(!(Math.min(n.bottom,t)-Math.max(n.top,0)<.2*n.height))return void clearActive();e.suspendUntil=0}else e.suspendUntil=0}const t=window.innerHeight,n=t/2;let i=null,o=1/0;for(const a of e.candidates){if(!a.img.isConnected){const e=a.element.querySelector("img, .img-preloader");if(!e)continue;a.img=e}const e=a.img.getBoundingClientRect();if(e.bottom<=0||e.top>=t)continue;if(!isInCenterBand(e,t))continue;const s=Math.abs(e.top+e.height/2-n);s<o&&(o=s,i=a)}i?function setActive(t){e.active&&e.active.element===t.element||(clearActive(),t.element.classList.add("auto-hover"),e.active=t)}(i):clearActive()}function requestUpdate(){e.ticking||(e.ticking=!0,requestAnimationFrame(update))}
//# sourceMappingURL=autoHover.js.map