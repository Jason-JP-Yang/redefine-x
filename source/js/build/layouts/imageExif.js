!function(){function checkFloatOverflow(e){if(!e.classList.contains("image-exif-float"))return;const t=e.querySelector(".image-exif-image-wrapper"),i=e.querySelector(".image-exif-info-card");if(!t||!i)return;const o=t.querySelector("img.image-exif-img"),a=t.querySelector(".img-preloader");let n=0;if(o&&o.complete&&o.naturalHeight>0?n=o.offsetHeight||o.clientHeight:a&&(n=a.offsetHeight||a.clientHeight),0===n)return;const l=i.cloneNode(!0);l.classList.remove("expanded"),Object.assign(l.style,{display:"block",visibility:"hidden",position:"absolute",top:"0",left:"0",width:"max-content",maxWidth:"60%",height:"auto",maxHeight:"none",overflow:"visible",boxSizing:"border-box",padding:"0.65rem",background:"transparent",zIndex:"-9999"});const s=l.querySelector(".image-exif-data");s&&Object.assign(s.style,{display:"grid",height:"auto",opacity:"1",marginTop:"0.6rem",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"0.6rem"});const c=l.querySelector(".image-exif-toggle-btn");c&&(c.style.display="none"),t.appendChild(l);const r=l.offsetHeight,d=l.scrollHeight,f=Math.max(r,d);t.removeChild(l);f>n-24-2?e.classList.contains("image-exif-overflow-fallback")||(e.classList.add("image-exif-overflow-fallback"),i.style.display="",i.style.visibility="",i.style.opacity=""):e.classList.contains("image-exif-overflow-fallback")&&(i.style.transition="none",e.classList.remove("image-exif-overflow-fallback"),i.offsetHeight,i.style.transition="")}function initImageExif(){document.querySelectorAll(".image-exif-container").forEach((e=>{e.querySelectorAll(".image-exif-toggle-btn").forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation(),function handleToggle(e){const t=e.closest(".image-exif-info-card");if(!t)return;const i=t.querySelector(".image-exif-data");if(!i)return;t.classList.contains("expanded")?(i.style.height=i.scrollHeight+"px",i.offsetHeight,t.classList.remove("expanded"),i.style.height="0"):(i.style.height="0px",i.offsetHeight,t.classList.add("expanded"),i.style.height=i.scrollHeight+"px",i.addEventListener("transitionend",(function(){t.classList.contains("expanded")&&(i.style.height="auto")}),{once:!0}))}(e)}))})),checkFloatOverflow(e);e.querySelectorAll("img.image-exif-img").forEach((t=>{t.complete||t.addEventListener("load",(()=>{checkFloatOverflow(e)}))}));e.querySelectorAll(".img-preloader").forEach((t=>{new MutationObserver((t=>{t.forEach((t=>{t.addedNodes.forEach((t=>{"IMG"===t.tagName&&(t.addEventListener("load",(()=>{checkFloatOverflow(e)})),t.complete&&checkFloatOverflow(e))}))}))})).observe(t,{childList:!0})}))}))}function handleResize(){document.querySelectorAll(".image-exif-container.image-exif-float").forEach((e=>{checkFloatOverflow(e)}))}let e,t=!1;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initImageExif):initImageExif(),document.addEventListener("swup:contentReplaced",initImageExif),document.addEventListener("pjax:complete",initImageExif),window.addEventListener("resize",(function debouncedResize(){t||(clearTimeout(e),e=setTimeout((()=>{t||(t=!0,requestAnimationFrame((()=>{handleResize(),t=!1})))}),150))}));const i=document.querySelector(".page-aside-toggle");i&&i.addEventListener("click",(()=>{setTimeout(handleResize,300)}))}();
//# sourceMappingURL=imageExif.js.map